# 1.训练数据

## 文件夹目录结构

a) 我们将提供用于训练的图像数据和识别标签，文件夹结构：
    o defect
	o normal
	o Annotations
 o README.md
b) defect : 存放有瑕疵的图像数据，normal存放无疵点的图像数据，jpeg编码图像文件。
c) Annotations : 存放属性标签标注数据。
d) README.md：对数据的详细介绍。

**与初赛有所差异的是**，考虑到花色布样种类较多，为了给大家提供更丰富的算法设计空间，每张图片都配备了一张模板图片。defect和normal文件下每一张图片都有一张模板图片。例如：defect文件下有0907A1_0cbd6cf81eb579551201909071534465文件夹，文件中有两张图片，分别是template_0907A1.jpg和0907A1_0cbd6cf81eb579551201909071534465.jpg，其中**template_0907A1.jpg是无瑕疵的模板图片，用于辅助选手**，不强制使用该图片，提交的预测结果中也不得出现该文件名称。

**测试集与训练集一样，每张图片都会提供模板图片**；

## 标注格式说明

训练集的标注文件在Annotations文件下的json文件中，数据标注格式如下：

```
[
    {
        "name": "0907A1_0cbd6cf81eb579551201909071534465.jpg",
        "defect_name": "\u65ad\u6c28\u7eb6",
        "bbox": [
            2347.4,
            194.92,
            2364.01,
            229.81
        ]
    },
    {
        "name": "0907A1_0cbd6cf81eb579551201909071534465.jpg",
        "defect_name": "\u65ad\u6c28\u7eb6",
        "bbox": [
            1646.51,
            598.38,
            1672.07,
            623.94
        ]
    },
    ... ...
    ,
        {
        "name": "0907A1_0cbd6cf81eb579551201909071534465.jpg",
        "defect_name": "\u4e09\u4e1d",
        "bbox": [
            2258.05,
            105.49,
            2274.48,
            169.38
        ]
    }
]
```

#### 格式说明

1.json文件中包含多个疵点样本，每个疵点样本都包含name、defect_name、bbox三个字段。

2.name字段为训练图片的文件名；defect_name字段为该疵点详细的疵点名称；bbox为xyxy格式坐标框；

3.对于存在多个疵点的图片，在标注文件中依次列出了每个疵点样本；

4.normal Images中的图片无疵点图片，没有在标注文件中出现。

5.defect_name字段中的疵点名称，是疵点的**中文名称**，编码格式为unicode。与要求提交结果文件中的category字段的映射关系如下。

## 疵点名称对应的category id

| 类别名      | 无疵点 | 沾污 | 错花 | 水印 | 花毛 | 缝头 | 缝头印 | 虫粘 | 破洞 | 褶子 |
| ----------- | ------ | ---- | ---- | ---- | ---- | ---- | ------ | ---- | ---- | ---- |
| category id | 0      | 1    | 2    | 3    | 4    | 5    | 6      | 7    | 8    | 9    |

| 类别名      | 织疵 | 漏印 | 蜡斑 | 色差 | 网折 | 其他 |      |      |      |      |
| ----------- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| category id | 10   | 11   | 12   | 13   | 14   | 15   |      |      |      |      |

# 2.结果文件格式

参赛者需要提交一份json文件，文件内容如下：

```
[
    {
        "name": "0907A1_0cbd6cf81eb579551201909071534465.jpg",
        "category": 1,
        "bbox": [339.66,15.65,356.00,61.33],
        "score": 0.0087397042
    },
    {
        "name": "0907A1_0cbd6cf81eb579551201909071534465.jpg",
        "category": 2,
        "bbox": [52.86,174.86,104.91,633.56],
        "score": 0.5624360123
    },
    ... ...
    ,
    {
        "name": "0907A1_5775468178515dee1201909071511514.jpg",
        "category": 2,
        "bbox": [339.61,7.21,355.94,48.61],
        "score": 0.0135210491
    }
]
```

#### 格式说明

1.提交的json文件中包含多个疵点样本，每个疵点样本都包含name、category、bbox、score四个字段。

2.name字段为图片名称；category字段为类别标签；bbox为xyxy格式坐标框，小数点后保留2位；score为置信度概率，范围0-1；

3.对于单张图片存在多个疵点样本时，依次列出即可；对于不存在疵点的无疵点图片，不能出现在json列表中。

4.name字段不允许出现非测试集中的图片名。

**注意：**最终提交的结果不提交模板图片，即模板图片名称不得出现在提交文件中。提交的j son文件的“name”字段是带“.jpg”后缀的图片名称，而**不是文件夹名称**。

#### 生成示例

json文件代码生成存储示例如下（python）：

```
result=[]
result.append({'name': image_name(str), 'category': defect_label(int),
							 'bbox':bbox(xyxy,float),'score': score(float)})
import json
with open('result.json', 'w') as fp:
     json.dump(result, fp, indent=4, separators=(',', ': '))
```

#3.与初赛之间的其他差异

###### 1.训练集中给出的数据大约有40种花色图案，每种花色有一些瑕疵图片和正常图片，每张图片都附加了正常图片的模板；

###### 2.在测试集中，除了训练集给出的40种花色图案之外，还会额外出现其他的几十种图案(不在训练集中)。

